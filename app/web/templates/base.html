<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}HillsInspector{% endblock %}</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="stylesheet" href="/static/leaflet/leaflet.css">
    <script src="/static/leaflet/leaflet.js"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <style>
        .search-item { display:block; padding:8px 12px; text-decoration:none; color:#333; border-bottom:1px solid #eee; }
        .search-item:hover { background:#f0f4ff; }
        .search-item strong { display:block; font-size:0.95em; }
        .search-item .search-meta { font-size:0.8em; color:#888; }
        .search-item.muted { color:#999; font-style:italic; }
    </style>
</head>

<body>
    <header class="header">
        <div class="header-content">
            <a href="/" class="logo">HillsInspector</a>
            <nav class="nav">
                <a href="/" class="nav-link">Dashboard</a>
                <a href="/auctions" class="nav-link">Auctions</a>
                <a href="/review/hcpa-failures" class="nav-link">Review Queue</a>
                <a href="/history" class="nav-link">History</a>
            </nav>
            <div class="search-box" style="position:relative;">
                <input type="text" name="q" placeholder="Search address, folio, or owner..." hx-get="/api/search"
                    hx-trigger="keyup changed delay:500ms" hx-target="#search-results" hx-indicator="#search-spinner"
                    autocomplete="off">
                <span id="search-spinner" class="htmx-indicator">...</span>
                <div id="search-results" class="search-results" style="position:absolute;top:100%;left:0;right:0;z-index:1000;background:#fff;border:1px solid #ddd;border-radius:0 0 6px 6px;max-height:400px;overflow-y:auto;box-shadow:0 4px 12px rgba(0,0,0,0.15);"></div>
            </div>
        </div>
    </header>

    <main class="main-content">
        {% block content %}{% endblock %}
    </main>

    <footer class="footer">
        <p>HillsInspector - Hillsborough County Property Auction Analysis</p>
    </footer>

    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tab-link");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            var target = document.getElementById(tabName);
            target.style.display = "block";
            evt.currentTarget.className += " active";
            // Trigger lazy HTMX load on first tab activation
            htmx.trigger(target, 'tab-show');
        }

        // Ensure first tab is active on load if it exists
        document.addEventListener('DOMContentLoaded', function () {
            const firstTab = document.querySelector('.tab-link');
            if (firstTab) {
                firstTab.click();
            }
        });
    </script>
</body>

</html>